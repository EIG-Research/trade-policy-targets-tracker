y = 1,          # 1 = top side
xanchor = "left",
yanchor = "top",
title = list(text = "")
),
hovermode = "closest",
hoverlabel = list(bgcolor = eig_colors[1])
)
})
output$text_va <- renderUI({
HTML('<p>White House <a href = "https://www.whitehouse.gov/fact-sheets/2025/04/report-to-the-president-on-the-america-first-trade-policy-executive-summary/?utm_source=chatgpt.com" target="_blank"> trade</a> policy aims to reverse the “hollowing out of our manufacturing base” and strengthen domestic manufacturing capacity by increasing the cost of foreign-manufactured goods. Real value added in manufacturing was $2.4 trillion in Q4, 2024, and has risen steadily over the past few decades. We set the target to be the growth rate since Q1 2010.</p>'
)})
## Employment rate, native born men 18+ ##
emp_pop_ratio_df = tibble(
quarter = as.Date(as.yearqtr(time(emp_pop_ratio_m))),
emp_pop = as.numeric(emp_pop_ratio_m)*100,
hover_label = format(as.yearqtr(quarter), "%Y Q%q")
)
output$plotly_employment_pop_native <- renderPlotly({
# Dynamically generate tick dates: Q1 every 5 years
date_range <- range(emp_pop_ratio_df$quarter)
start_year <- lubridate::year(date_range[1])
end_year   <- lubridate::year(date_range[2])
# Add ticks
tick_years <- c(start_year,
seq((start_year %/% 5 + 2)*5, end_year %/% 5*5, by = 5))
tick_dates <- c(as.Date(paste0(tick_years, "-01-01")),
tail(date_range, 1)) %>% unique()  # Q1 of each year
tick_texts <- as.character(as.yearqtr(tick_dates))
y_lvl = emp_pop_ratio_df %>% mutate(year = lubridate::year(quarter)) %>%
filter(year == 2000) %>% summarise(mean(emp_pop))
y_lvl = as.numeric(y_lvl[1,1])
plot_ly(
data = emp_pop_ratio_df,
x = ~quarter,
y = ~emp_pop,
type = 'scatter',
mode = 'lines',
line = list(color = eig_colors[1], width = 2),
text = ~hover_label,
hovertemplate = "%{x}: %{y:,.1f}%<extra></extra>"
) %>%
layout(
xaxis = list(title = "Time (Quarterly)",
tickvals = tick_dates,
ticktext = tick_texts,
hoverformat = "%Y Q%q",
range = c(tick_dates[1], tick_dates[length(tick_dates)])),
yaxis = list(title = "Employment-to-Population Ratio (%)",
tickformat = ".0f",
ticksuffix = "%"),
hovermode = "closest",
hoverlabel = list(bgcolor = eig_colors[1]),
# add horizontal line
shapes = list(
list(
type = "line",
xref = "paper",
x0 = 0, x1 = 1,
y0 = y_lvl, y1 = y_lvl,
line = list(color = eig_colors[4], width = 2, dash = "dash")
)
),
# label for balance
annotations = list(
list(
xref = "paper",
x = 0.25,
y = y_lvl+0.3,
text = paste0("2000 level, before China joined the WTO = ",round(y_lvl,1),"%"),
showarrow = FALSE,
font = list(color = eig_colors[2], size = 12),
xanchor = "left",
yanchor = "middle"
)
)
)
})
output$text_employment_pop_native <- renderUI({
HTML('<p>According to Vice President J.D. Vance, the Trump Administration <a href="https://www.nytimes.com/2024/10/12/magazine/jd-vance-interview.html" target="_blank"> hopes</a> to raise native-born employment in part by imposing more severe immigration restrictions and creating new jobs by restricting trade. The native-born employment rate currently stands at 59.4 percent. We set the target to be 64.5 percent, which is the 2000 level before China joined the WTO.</p>'
)})
## Employment Manufacturing ##
manu_df = tibble(
quarter = as.Date(as.yearqtr(time(manu_qt))),
manufacturing = as.numeric(manu_qt),
hover_label = format(as.yearqtr(quarter), "%Y Q%q")
)
output$plotly_emp_manu <- renderPlotly({
# Dynamically generate tick dates: Q1 every 5 years
date_range <- range(manu_df$quarter)
start_year <- lubridate::year(date_range[1])
end_year   <- lubridate::year(date_range[2])
# Add ticks
tick_years <- c(start_year,
seq((start_year %/% 5 + 1)*5, end_year %/% 5*5, by = 5))
tick_dates <- c(as.Date(paste0(tick_years, "-01-01")),
tail(date_range, 1)) %>% unique()  # Q1 of each year
tick_texts <- as.character(as.yearqtr(tick_dates))
y_lvl = manu_df %>% mutate(year = lubridate::year(quarter)) %>%
filter(year == 2000) %>% summarise(y = mean(manufacturing))
y_lvl = as.numeric(y_lvl[1,1])
plot_ly(
data = manu_df,
x = ~quarter,
y = ~manufacturing,
type = 'scatter',
mode = 'lines',
line = list(color = eig_colors[1], width = 2),
text = ~hover_label,
hovertemplate = "%{x}: %{y:,.1f}M<extra></extra>"
) %>%
layout(
xaxis = list(title = "Time (Quarterly)",
tickvals = tick_dates,
ticktext = tick_texts,
hoverformat = "%Y Q%q",
range = c(tick_dates[1], tick_dates[length(tick_dates)])),
yaxis = list(title = "Employment (Millions of Workers)",
tickformat = ",.0f",
ticksuffix = ""),
hovermode = "closest",
hoverlabel = list(bgcolor = eig_colors[1]),
# add target line
shapes = list(
list(
type = "line",
xref = "paper",
x0 = 0, x1 = 1,
y0 = y_lvl, y1 = y_lvl,
line = list(color = eig_colors[4], width = 2, dash = "dash")
)
),
# add label for target
annotations = list(
list(
xref = "paper",
x = 0.27,
y = y_lvl + 0.2,
text = paste0("2000 level, before China joined the WTO = " , round(y_lvl, 1),"M"),
showarrow = FALSE,
font = list(color = eig_colors[2], size = 12),
xanchor = "left",
yanchor = "middle"
)
)
)
})
output$text_emp_manu <- renderUI({
HTML('<p>With the introduction of reciprocal tariffs on April 2nd, President Trump <a href = "https://www.nytimes.com/2025/04/03/business/economy/trump-tariffs-us-manufacturing-economy.html" target="_blank"> said</a> that “jobs and factories will come roaring back.” Manufacturing employment stands at 12.8 million in Q1 2025, down from the chosen target of 17.3 in 2000, the level from just before China joined the WTO in 2001.</p>'
)})
## Manufacturing Share ##
manu_share_df = tibble(
quarter = as.Date(as.yearqtr(time(manu_share))),
manufacturing_share = as.numeric(manu_share) *100,
hover_label = format(as.yearqtr(quarter), "%Y Q%q")
)
output$plotly_share_manu <- renderPlotly({
# Dynamically generate tick dates: Q1 every 5 years
date_range <- range(manu_share_df$quarter)
start_year <- lubridate::year(date_range[1])
end_year   <- lubridate::year(date_range[2])
tick_years <- c(start_year,
seq((start_year %/% 5 + 1)*5, end_year %/% 5*5, by = 5))
tick_dates <- c(as.Date(paste0(tick_years, "-01-01")),
tail(date_range, 1)) %>% unique()  # Q1 of each year
tick_texts <- as.character(as.yearqtr(tick_dates))
y_lvl = manu_share_df %>% mutate(year = lubridate::year(quarter)) %>%
filter(year == 2000) %>% summarise(y = mean(manufacturing_share))
y_lvl = as.numeric(y_lvl[1,1])
plot_ly(
data = manu_share_df,
x = ~quarter,
y = ~manufacturing_share,
type = 'scatter',
mode = 'lines',
line = list(color = eig_colors[1], width = 2),
text = ~hover_label,
hovertemplate = "%{x}: %{y:,.1f}%<extra></extra>") %>%
layout(
xaxis = list(title = "Time (Quarterly)",
tickvals = tick_dates,
ticktext = tick_texts,
hoverformat = "%Y Q%q",
range = c(tick_dates[1], tick_dates[length(tick_dates)])),
yaxis = list(title = "Share of Private-Sector Workers (%)",
tickformat = ".0f",
ticksuffix = "%"),
hovermode = "closest",
hoverlabel = list(bgcolor = eig_colors[1]),
# add target line
shapes = list(
list(
type = "line",
xref = "paper",
x0 = 0, x1 = 1,
y0 = y_lvl, y1 = y_lvl,
line = list(color = eig_colors[4], width = 2, dash = "dash")
)
),
# add label for target
annotations = list(
list(
xref = "paper",
x = 0.29,
y = y_lvl + 0.3,
text = paste0("2000 level, before China joined the WTO = " , round(y_lvl, 1),"%"),
showarrow = FALSE,
font = list(color = eig_colors[2], size = 12),
xanchor = "left",
yanchor = "middle"
)
)
)
})
output$text_share_manu <- renderUI({
HTML('<p>With the introduction of reciprocal tariffs on April 2nd, President Trump <a href = "https://www.nytimes.com/2025/04/03/business/economy/trump-tariffs-us-manufacturing-economy.html" target="_blank"> said</a> that “jobs and factories will come roaring back.” In Q1 2025, manufacturing jobs made up 9.4 percent of employment, down from the chosen target of 15.5 percent, the level from just before China joined the WTO in 2001.</p>'
)})
## Employment, motor vehicles and parts ##
motor_df = tibble(
quarter = as.Date(as.yearqtr(time(motor_qt))),
motor_level = as.numeric(motor_qt),
hover_label = format(as.yearqtr(quarter), "%Y Q%q")
)
output$plotly_motor_emp <- renderPlotly({
# Dynamically generate tick dates: Q1 every 5 years
date_range <- range(motor_df$quarter)
start_year <- lubridate::year(date_range[1])
end_year   <- lubridate::year(date_range[2])
tick_years <- c(start_year,
seq((start_year %/% 5 + 1)*5, end_year %/% 5*5, by = 5))
tick_dates <- c(as.Date(paste0(tick_years, "-01-01")),
tail(date_range, 1)) %>% unique()  # Q1 of each year
tick_texts <- as.character(as.yearqtr(tick_dates))
y_lvl = motor_df %>% mutate(year = lubridate::year(quarter)) %>%
filter(year == 2000) %>% summarise(y = mean(motor_level))
y_lvl = as.numeric(y_lvl[1,1])
plot_ly(
data = motor_df,
x = ~quarter,
y = ~motor_level,
type = 'scatter',
mode = 'lines',
line = list(color = eig_colors[1], width = 2),
text = ~hover_label,
hovertemplate = "%{x}: %{y:,.1f}M<extra></extra>") %>%
layout(
xaxis = list(title = "Time (Quarterly)",
tickvals = tick_dates,
ticktext = tick_texts,
hoverformat = "%Y Q%q",
range = c(tick_dates[1], tick_dates[length(tick_dates)])),
yaxis = list(title = "Employment (Millions of Workers)",
tickformat = ".1f",
ticksuffix = ""),
hovermode = "closest",
hoverlabel = list(bgcolor = eig_colors[1]),
# add target line
shapes = list(
list(
type = "line",
xref = "paper",
x0 = 0, x1 = 1,
y0 = y_lvl, y1 = y_lvl,
line = list(color = eig_colors[4], width = 2, dash = "dash")
)
),
# add label for target
annotations = list(
list(
xref = "paper",
x = 0.33,
y = y_lvl + 0.025,
text = paste0("2000 level, before China joined the WTO = " , round(y_lvl, 1),"M"),
showarrow = FALSE,
font = list(color = eig_colors[2], size = 12),
xanchor = "left",
yanchor = "middle"
)
)
)
})
output$text_motor_emp <- renderUI({
HTML('<p>With the introduction of reciprocal tariffs on April 2nd, President Trump <a href = "https://www.nytimes.com/2025/04/03/business/economy/trump-tariffs-us-manufacturing-economy.html" target="_blank"> said</a> that “jobs and factories will come roaring back.” There are 1.0 million vehicle-related manufacturing jobs, down from 1.3 million in 2000, the level from just before China joined the WTO in 2001.</p>'
)})
## Motor vehicles and parts share of private employment ##
motor_share_df = tibble(
quarter = as.Date(as.yearqtr(time(motor_share))),
motor_share = as.numeric(motor_share)*100,
hover_label = format(as.yearqtr(quarter), "%Y Q%q")
)
output$plotly_motor_share <- renderPlotly({
# Dynamically generate tick dates: Q1 every 5 years
date_range <- range(motor_share_df$quarter)
start_year <- lubridate::year(date_range[1])
end_year   <- lubridate::year(date_range[2])
tick_years <- c(start_year,
seq((start_year %/% 5 + 1)*5, end_year %/% 5*5, by = 5))
tick_dates <- c(as.Date(paste0(tick_years, "-01-01")),
tail(date_range, 1)) %>% unique()  # Q1 of each year
tick_texts <- as.character(as.yearqtr(tick_dates))
y_lvl = motor_share_df %>% mutate(year = lubridate::year(quarter)) %>%
filter(year == 2000) %>% summarise(y = mean(motor_share))
y_lvl = as.numeric(y_lvl[1,1])
plot_ly(
data = motor_share_df,
x = ~quarter,
y = ~motor_share,
type = 'scatter',
mode = 'lines',
line = list(color = eig_colors[1], width = 2),
text = ~hover_label,
hovertemplate = "%{x}: %{y:,.1f}%<extra></extra>") %>%
layout(
xaxis = list(title = "Time (Quarterly)",
tickvals = tick_dates,
ticktext = tick_texts,
hoverformat = "%Y Q%q",
range = c(tick_dates[1], tick_dates[length(tick_dates)])),
yaxis = list(title = "Share of Private-Sector Workers (%)",
tickformat = ".1f",
ticksuffix = "%"),
hovermode = "closest",
hoverlabel = list(bgcolor = eig_colors[1]),
# add target line
shapes = list(
list(
type = "line",
xref = "paper",
x0 = 0, x1 = 1,
y0 = y_lvl, y1 = y_lvl,
line = list(color = eig_colors[4], width = 2, dash = "dash")
)
),
# add label for target
annotations = list(
list(
xref = "paper",
x = 0.31,
y = y_lvl + 0.015,
text = paste0("2000 level, before China joined the WTO = " , round(y_lvl, 1),"%"),
showarrow = FALSE,
font = list(color = eig_colors[2], size = 12),
xanchor = "left",
yanchor = "middle"
)
)
)
})
output$text_motor_share <- renderUI({
HTML('<p>With the introduction of reciprocal tariffs on April 2nd, President Trump <a href = "https://www.nytimes.com/2025/04/03/business/economy/trump-tariffs-us-manufacturing-economy.html" target="_blank"> said</a> that “jobs and factories will come roaring back.” Vehicle-related manufacturing jobs made up 0.7 percent of total U.S. jobs in Q1 2025, down from 1.2 percent in 2000, the level from just before China joined the WTO in 2001.</p>'
)})
## Employment in manufacturing, counties most affected by the "China shock"  ##
china_shock_df <- tibble(year = time(china_shock_yr),
cs_manu_emp = as.numeric(china_shock_yr),
hover_label = as.character(year))
output$plotly_china_shock <- renderPlotly({
# Dynamically generate tick dates: Q1 every 5 years
start_year <- china_shock_df$year[1]
end_year   <- china_shock_df$year[nrow(china_shock_df)]
tick_years <- c(seq(start_year, end_year, by = 5), end_year)
tick_texts <- as.character(tick_years)
y_lvl <- china_shock_df %>% filter(year == 2000) %>% .$cs_manu_emp
plot_ly(
data = china_shock_df,
x = ~year,
y = ~cs_manu_emp,
type = 'scatter',
mode = 'lines',
line = list(color = eig_colors[1], width = 2),
text = ~hover_label,
hovertemplate = "%{x}: %{y:,.1f}K<extra></extra>"
) %>%
layout(
xaxis = list(title = "Time (Annual)",
tickvals = tick_years,
hoverformat = "%Y Q%q",
range = c(tick_years[1], tick_years[length(tick_years)])),
yaxis = list(title = "Employment (Thousands of Workers)",
tickformat = ".0f",
ticksuffix = ""),
hovermode = "closest",
# add target line
shapes = list(
list(
type = "line",
xref = "paper",
x0 = 0, x1 = 1,
y0 = y_lvl, y1 = y_lvl,
line = list(color = eig_colors[4], width = 2, dash = "dash")
)
),
# add label for target
annotations = list(
list(
xref = "paper",
x = 0.28,
y = y_lvl + 8,
text = paste0("2000 level, before China joined the WTO = " , round(y_lvl, 1),"K"),
showarrow = FALSE,
font = list(color = eig_colors[2], size = 12),
xanchor = "left",
yanchor = "middle"
)
)
)
})
output$text_china_shock <- renderUI({
HTML('<p>Identified by <a href = "https://www.nber.org/papers/w21906" target="_blank"> Autor et al. (2016),</a> manufacturing employment in the 145 counties most impacted by trade with China is 473 thousand jobs (2022). The target is set at 649 thousand, the total employment in these counties just before China joined the WTO in 2001.</p>'
)})
}
shinyApp(ui = ui, server = server)
# remove dependencies
rm(list = ls())
###########################
###   Load Packages     ###
###########################
library(tidyr)
library(dplyr)
library(tidycensus)
library(scales)
library(readxl)
#################
### Set paths ###
#################
# Define user-specific project directories
project_directories <- list(
"name" = "PATH TO GITHUB REPO",
"sarah" = "/Users/sarah/Documents/GitHub/trade-policy-targets-tracker"
"jiaxinhe" = "/Users/jiaxinhe/Documents/projects/trade-policy-targets-tracker"
#################
### Set paths ###
#################
# Define user-specific project directories
project_directories <- list(
"name" = "PATH TO GITHUB REPO",
"sarah" = "/Users/sarah/Documents/GitHub/trade-policy-targets-tracker",
"jiaxinhe" = "/Users/jiaxinhe/Documents/projects/trade-policy-targets-tracker"
)
# Setting project path based on current user
current_user <- Sys.info()[["user"]]
if (!current_user %in% names(project_directories)) {
stop("Root folder for current user is not defined.")
}
path_project <- project_directories[[current_user]]
path_data <- file.path(path_project, "data")
path_bea <- file.path(path_data, "BEA")
path_va <- file.path(path_data, "Value Added")
path_app <- file.path(path_project, "trade-target-tracker")
path_appdata <- file.path(path_app, "cleaned_data")
# Load 2017 real dollar adjustments from cleaned FRED data
load(file.path(path_appdata, "fred_data.RData"))
# Import trade balance data downloaded from BEA
# Link: https://www.bea.gov/data/intl-trade-investment/international-trade-goods-and-services
# Monthly aggregate: U.S. Trade in Goods and Services, 1960-present, Table 1
# Quarterly with China: U.S. Trade in Goods and Services by Selected Countries and Areas, 1999-present, Table 3
trade_agg_month <- read_xlsx(file.path(path_bea, "trad-time-series-0225.xlsx"),
sheet = "Table 1",
skip = 74)
View(trade_agg_month)
# Import trade balance data downloaded from BEA
# Link: https://www.bea.gov/data/intl-trade-investment/international-trade-goods-and-services
# Monthly aggregate: U.S. Trade in Goods and Services, 1960-present, Table 1
# Quarterly with China: U.S. Trade in Goods and Services by Selected Countries and Areas, 1999-present, Table 3
trade_agg_month <- read_xlsx(file.path(path_bea, "trad-time-series-0225.xlsx"),
sheet = "Table 1",
skip = 74) %>%
select(1,3) %>%
na.omit() %>% rename(month = Monthly, balance = `...3`)
trade_china_qt <- read_xlsx(file.path(path_bea, "trad-geo-time-series-0125.xlsx"),
sheet = "Table 6", # balance on goods only
skip = 5)
View(trade_china_qt)
trade_china_qt <- read_xlsx(file.path(path_bea, "trad-geo-time-series-0125.xlsx"),
sheet = "Table 6", # balance on goods only
skip = 5) %>% slice(29:n()) %>% select(Period, China) %>%
na.omit() %>% rename(quarter = Period, balance = China)
# Monthly goods trade with China from 1992 to 1998 are obtained from Census
# Link: https://www.census.gov/foreign-trade/balance/c5700.html
trade_china_hist <- read.csv(file.path(path_bea, "trad-china-hist-92-98.csv")) %>%
select(Month, Balance) %>% rename(month = Month, balance = Balance)
trade_china_hist$balance <- round(as.numeric(sub(",", "", trade_china_hist$balance)), digits = 0)
# Real value added by industry
va_manu_q <- read.csv(file.path(path_va, "real_VA_manu_2005_2024_Q.csv"), skip = 3, header = TRUE)
va_manu_q <- head(va_manu_q, -5) %>% select(-1:-2)
va_manu_2005_2024_qt <- as.numeric(unlist(va_manu_q[2,])) %>%
ts(., start = c(2005, 1), frequency = 4) / 1000
va_manu_a <- read.csv(file.path(path_va, "real_VA_manu_1997_2004_A.csv"), skip = 3, header = TRUE)
va_manu_a <- head(va_manu_a, -5) %>% select(-1:-2) %>% na.omit()
va_manu_1997_2004_year <- as.numeric(unlist(va_manu_a[1,])) %>%
ts(., start = c(1997, 1), frequency = 1) / 1000
# Aggregate quarterly total trade balance
trade_agg_qt <- trade_agg_month$balance %>% ts(., start = c(1992,1), frequency = 12) %>%
aggregate(., nfrequency = 4, FUN = sum)
# Aggregate quarterly China trade balance
# Seasonally adjust historical data
trade_china_qt_92_98 <- final(seas(trade_china_hist$balance %>%
ts(., start = c(1992,1), frequency = 12))) %>%
aggregate(., nfrequency = 4, FUN = sum)
trade_china_qt_99_24 <- trade_china_qt$balance %>% ts(., start = c(1999,1), frequency = 4)
trade_china_qt <- round(ts(c(trade_china_qt_92_98, trade_china_qt_99_24), start = start(trade_china_qt_92_98),
frequency = 4), digits = 0)
###########################
###   Load Packages     ###
###########################
library(tidyr)
library(dplyr)
library(tidycensus)
library(scales)
library(readxl)
# Aggregate quarterly total trade balance
trade_agg_qt <- trade_agg_month$balance %>% ts(., start = c(1992,1), frequency = 12) %>%
aggregate(., nfrequency = 4, FUN = sum)
