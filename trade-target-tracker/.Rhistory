)})
## Construction Spending ##
const_df <- tibble(
quarter = as.Date(time(construction_real)),
const_spending = as.numeric(construction_real),
hover_label = format(as.yearqtr(quarter), "%Y Q%q")
)
output$plotly_const <- renderPlotly({
# Dynamically generate tick dates: Q1 every 5 years
date_range <- range(const_df$quarter)
start_year <- lubridate::year(date_range[1])
end_year   <- lubridate::year(date_range[2])
# Add ticks
tick_years <- c(start_year,
seq((start_year %/% 5 + 1)*5, end_year %/% 5*5, by = 5))
tick_dates <- c(as.Date(paste0(tick_years, "-01-01")),
tail(date_range, 1)) %>% unique()  # Q1 of each year
tick_texts <- as.character(as.yearqtr(tick_dates))
plot_ly(
data = const_df,
x = ~quarter,
y = ~const_spending,
type = 'scatter',
mode = 'lines',
line = list(color = eig_colors[1], width = 2),
text = ~hover_label,
hovertemplate = "%{x}: %{y:$,.1f}B<extra></extra>"
) %>%
layout(
xaxis = list(title = "Time (Quarterly)",
tickvals = tick_dates,
ticktext = tick_texts,
hoverformat = "%Y Q%q",
range = c(tick_dates[1], tick_dates[length(tick_dates)])),
yaxis = list(title = "Construction Spending (Billions of Dollars)",
tickformat = ",.0f",
ticksuffix = ""),
legend = list(title = list(text = "Manufacturing Value Added")),
hovermode = "closest",
hoverlabel = list(bgcolor = eig_colors[1])
)
})
output$text_const <- renderUI({
HTML('<p>The Trump administration aims to <a href="https://www.whitehouse.gov/presidential-actions/2025/04/restoring-americas-maritime-dominance/" target="_blank"> re-shore factories,</a> with an emphasis on shipbuilding. Construction spending on manufacturing facilities was $37.7 billion in Q4 2024. As construction spending rose markedly during the Biden administration, it is difficult to set a target.</p>'
)})
## Value Added ##
va_df <- tibble(
quarter = c(as.Date(time(va_manu_1997_2004_year)), as.Date(time(va_manu_2005_2024_qt))),
value_added = c(as.matrix(va_manu_1997_2004_year), as.matrix(va_manu_2005_2024_qt)),
hover_label = format(as.yearqtr(quarter), "%Y Q%q")
)
va_df_trend <- va_df %>%
filter(quarter >= as.Date("2010-01-01"),
quarter != as.Date("2020-04-01"))
trend_model <- lm(value_added ~ as.numeric(quarter), data = va_df_trend)
va_df <- va_df %>%
mutate(trend = predict(trend_model, newdata = data.frame(quarter = as.numeric(quarter))))
output$plotly_va <- renderPlotly({
# Dynamically generate tick dates: Q1 every 5 years
date_range <- range(va_df$quarter)
start_year <- lubridate::year(date_range[1])
end_year   <- lubridate::year(date_range[2])
# Add ticks
tick_years <- c(start_year,
seq((start_year %/% 5 + 1)*5, end_year %/% 5*5, by = 5))
tick_dates <- c(as.Date(paste0(tick_years, "-01-01")),
tail(date_range, 1))  # Q1 of each year
tick_texts <- as.character(as.yearqtr(tick_dates))
plot_ly(
data = va_df,
x = ~quarter,
y = ~value_added,
type = 'scatter',
mode = 'lines',
name = "Real Value Added Levels",
line = list(color = eig_colors[1], width = 2),
text = ~hover_label,
hovertemplate = "%{x}: %{y:$,.0f}B<extra></extra>"
) %>%
add_trace(
data = va_df_trend,
x = ~quarter,
y = ~predict(trend_model),
name = "Trendline after the Great Financial Crisis",
line = list(color = eig_colors[2], width = 2, dash = "dash"),
hoverinfo = "none",
hovertemplate = NULL,
showlegend = TRUE
) %>%
layout(
xaxis = list(title = "Time (Quarterly)",
tickvals = tick_dates,
ticktext = tick_texts,
hoverformat = "%Y Q%q",
range = c(tick_dates[1], tick_dates[length(tick_dates)])),
yaxis = list(title = "Value Added (Billions of Dollars)",
tickformat = ",.0f",
ticksuffix = ""),
legend = list(
x = 0,          # 0 = left side
y = 1,          # 1 = top side
xanchor = "left",
yanchor = "top",
title = list(text = "")
),
hovermode = "closest",
hoverlabel = list(bgcolor = eig_colors[1])
)
})
output$text_va <- renderUI({
HTML('<p>White House <a href = "https://www.whitehouse.gov/fact-sheets/2025/04/report-to-the-president-on-the-america-first-trade-policy-executive-summary/?utm_source=chatgpt.com" target="_blank"> trade</a> policy aims to reverse the “hollowing out of our manufacturing base” and strengthen domestic manufacturing capacity by increasing the cost of foreign-manufactured goods. Real value added in manufacturing was $2.4 trillion in Q4, 2024, and has risen steadily over the past few decades. We set the target to be the growth rate since Q1 2010.</p>'
)})
## Employment rate, native born men 18+ ##
emp_pop_ratio_df = tibble(
quarter = as.Date(as.yearqtr(time(emp_pop_ratio_m))),
emp_pop = as.numeric(emp_pop_ratio_m)*100,
hover_label = format(as.yearqtr(quarter), "%Y Q%q")
)
output$plotly_employment_pop_native <- renderPlotly({
# Dynamically generate tick dates: Q1 every 5 years
date_range <- range(emp_pop_ratio_df$quarter)
start_year <- lubridate::year(date_range[1])
end_year   <- lubridate::year(date_range[2])
# Add ticks
tick_years <- c(start_year,
seq((start_year %/% 5 + 2)*5, end_year %/% 5*5, by = 5))
tick_dates <- c(as.Date(paste0(tick_years, "-01-01")),
tail(date_range, 1)) %>% unique()  # Q1 of each year
tick_texts <- as.character(as.yearqtr(tick_dates))
y_lvl = emp_pop_ratio_df %>% mutate(year = lubridate::year(quarter)) %>%
filter(year == 2000) %>% summarise(mean(emp_pop))
y_lvl = as.numeric(y_lvl[1,1])
plot_ly(
data = emp_pop_ratio_df,
x = ~quarter,
y = ~emp_pop,
type = 'scatter',
mode = 'lines',
line = list(color = eig_colors[1], width = 2),
text = ~hover_label,
hovertemplate = "%{x}: %{y:,.1f}%<extra></extra>"
) %>%
layout(
xaxis = list(title = "Time (Quarterly)",
tickvals = tick_dates,
ticktext = tick_texts,
hoverformat = "%Y Q%q",
range = c(tick_dates[1], tick_dates[length(tick_dates)])),
yaxis = list(title = "Employment-to-Population Ratio (%)",
tickformat = ".0f",
ticksuffix = "%"),
hovermode = "closest",
hoverlabel = list(bgcolor = eig_colors[1]),
# add horizontal line
shapes = list(
list(
type = "line",
xref = "paper",
x0 = 0, x1 = 1,
y0 = y_lvl, y1 = y_lvl,
line = list(color = eig_colors[1], width = 2, dash = "dash")
)
),
# label for balance
annotations = list(
list(
xref = "paper",
x = 0.25,
y = y_lvl+0.3,
text = paste0("2000 level, before China joined the WTO = ",round(y_lvl,1),"%"),
showarrow = FALSE,
font = list(color = eig_colors[2], size = 12),
xanchor = "left",
yanchor = "middle"
)
)
)
})
output$text_employment_pop_native <- renderUI({
HTML('<p>According to Vice President J.D. Vance, the Trump Administration <a href="https://www.nytimes.com/2024/10/12/magazine/jd-vance-interview.html" target="_blank"> hopes</a> to raise native-born employment in part by imposing more severe immigration restrictions and creating new jobs by restricting trade. The native-born employment rate currently stands at 59.4 percent. We set the target to be 64.5 percent, which is the 2000 level before China joined the WTO.</p>'
)})
## Employment Manufacturing ##
manu_df = tibble(
quarter = as.Date(as.yearqtr(time(manu_qt))),
manufacturing = as.numeric(manu_qt),
hover_label = format(as.yearqtr(quarter), "%Y Q%q")
)
output$plotly_emp_manu <- renderPlotly({
# Dynamically generate tick dates: Q1 every 5 years
date_range <- range(manu_df$quarter)
start_year <- lubridate::year(date_range[1])
end_year   <- lubridate::year(date_range[2])
# Add ticks
tick_years <- c(start_year,
seq((start_year %/% 5 + 1)*5, end_year %/% 5*5, by = 5))
tick_dates <- c(as.Date(paste0(tick_years, "-01-01")),
tail(date_range, 1)) %>% unique()  # Q1 of each year
tick_texts <- as.character(as.yearqtr(tick_dates))
y_lvl = manu_df %>% mutate(year = lubridate::year(quarter)) %>%
filter(year == 2000) %>% summarise(y = mean(manufacturing))
y_lvl = as.numeric(y_lvl[1,1])
plot_ly(
data = manu_df,
x = ~quarter,
y = ~manufacturing,
type = 'scatter',
mode = 'lines',
line = list(color = eig_colors[1], width = 2),
text = ~hover_label,
hovertemplate = "%{x}: %{y:,.1f}M<extra></extra>"
) %>%
layout(
xaxis = list(title = "Time (Quarterly)",
tickvals = tick_dates,
ticktext = tick_texts,
hoverformat = "%Y Q%q",
range = c(tick_dates[1], tick_dates[length(tick_dates)])),
yaxis = list(title = "Employment (Millions of Workers)",
tickformat = ",.0f",
ticksuffix = ""),
hovermode = "closest",
hoverlabel = list(bgcolor = eig_colors[1]),
# add target line
shapes = list(
list(
type = "line",
xref = "paper",
x0 = 0, x1 = 1,
y0 = y_lvl, y1 = y_lvl,
line = list(color = eig_colors[1], width = 2, dash = "dash")
)
),
# add label for target
annotations = list(
list(
xref = "paper",
x = 0.27,
y = y_lvl + 0.2,
text = paste0("2000 level, before China joined the WTO = " , round(y_lvl, 1),"M"),
showarrow = FALSE,
font = list(color = eig_colors[2], size = 12),
xanchor = "left",
yanchor = "middle"
)
)
)
})
output$text_emp_manu <- renderUI({
HTML('<p>With the introduction of reciprocal tariffs on April 2nd, President Trump <a href = "https://www.nytimes.com/2025/04/03/business/economy/trump-tariffs-us-manufacturing-economy.html" target="_blank"> said</a> that “jobs and factories will come roaring back.” Manufacturing employment stands at 12.8 million in Q1 2025, down from the chosen target of 17.3 in 2000, the level from just before China joined the WTO in 2001.</p>'
)})
## Manufacturing Share ##
manu_share_df = tibble(
quarter = as.Date(as.yearqtr(time(manu_share))),
manufacturing_share = as.numeric(manu_share) *100,
hover_label = format(as.yearqtr(quarter), "%Y Q%q")
)
output$plotly_share_manu <- renderPlotly({
# Dynamically generate tick dates: Q1 every 5 years
date_range <- range(manu_share_df$quarter)
start_year <- lubridate::year(date_range[1])
end_year   <- lubridate::year(date_range[2])
tick_years <- c(start_year,
seq((start_year %/% 5 + 1)*5, end_year %/% 5*5, by = 5))
tick_dates <- c(as.Date(paste0(tick_years, "-01-01")),
tail(date_range, 1)) %>% unique()  # Q1 of each year
tick_texts <- as.character(as.yearqtr(tick_dates))
y_lvl = manu_share_df %>% mutate(year = lubridate::year(quarter)) %>%
filter(year == 2000) %>% summarise(y = mean(manufacturing_share))
y_lvl = as.numeric(y_lvl[1,1])
plot_ly(
data = manu_share_df,
x = ~quarter,
y = ~manufacturing_share,
type = 'scatter',
mode = 'lines',
line = list(color = eig_colors[1], width = 2),
text = ~hover_label,
hovertemplate = "%{x}: %{y:,.1f}%<extra></extra>") %>%
layout(
xaxis = list(title = "Time (Quarterly)",
tickvals = tick_dates,
ticktext = tick_texts,
hoverformat = "%Y Q%q",
range = c(tick_dates[1], tick_dates[length(tick_dates)])),
yaxis = list(title = "Share of Private-Sector Workers (%)",
tickformat = ".0f",
ticksuffix = "%"),
hovermode = "closest",
hoverlabel = list(bgcolor = eig_colors[1]),
# add target line
shapes = list(
list(
type = "line",
xref = "paper",
x0 = 0, x1 = 1,
y0 = y_lvl, y1 = y_lvl,
line = list(color = eig_colors[1], width = 2, dash = "dash")
)
),
# add label for target
annotations = list(
list(
xref = "paper",
x = 0.29,
y = y_lvl + 0.3,
text = paste0("2000 level, before China joined the WTO = " , round(y_lvl, 1),"%"),
showarrow = FALSE,
font = list(color = eig_colors[2], size = 12),
xanchor = "left",
yanchor = "middle"
)
)
)
})
output$text_share_manu <- renderUI({
HTML('<p>With the introduction of reciprocal tariffs on April 2nd, President Trump <a href = "https://www.nytimes.com/2025/04/03/business/economy/trump-tariffs-us-manufacturing-economy.html" target="_blank"> said</a> that “jobs and factories will come roaring back.” In Q1 2025, manufacturing jobs made up 9.4 percent of employment, down from the chosen target of 15.5 percent, the level from just before China joined the WTO in 2001.</p>'
)})
## Employment, motor vehicles and parts ##
motor_df = tibble(
quarter = as.Date(as.yearqtr(time(motor_qt))),
motor_level = as.numeric(motor_qt),
hover_label = format(as.yearqtr(quarter), "%Y Q%q")
)
output$plotly_motor_emp <- renderPlotly({
# Dynamically generate tick dates: Q1 every 5 years
date_range <- range(motor_df$quarter)
start_year <- lubridate::year(date_range[1])
end_year   <- lubridate::year(date_range[2])
tick_years <- c(start_year,
seq((start_year %/% 5 + 1)*5, end_year %/% 5*5, by = 5))
tick_dates <- c(as.Date(paste0(tick_years, "-01-01")),
tail(date_range, 1)) %>% unique()  # Q1 of each year
tick_texts <- as.character(as.yearqtr(tick_dates))
y_lvl = motor_df %>% mutate(year = lubridate::year(quarter)) %>%
filter(year == 2000) %>% summarise(y = mean(motor_level))
y_lvl = as.numeric(y_lvl[1,1])
plot_ly(
data = motor_df,
x = ~quarter,
y = ~motor_level,
type = 'scatter',
mode = 'lines',
line = list(color = eig_colors[1], width = 2),
text = ~hover_label,
hovertemplate = "%{x}: %{y:,.1f}K<extra></extra>") %>%
layout(
xaxis = list(title = "Time (Quarterly)",
tickvals = tick_dates,
ticktext = tick_texts,
hoverformat = "%Y Q%q",
range = c(tick_dates[1], tick_dates[length(tick_dates)])),
yaxis = list(title = "Employment (Millions of Workers)",
tickformat = ".1f",
ticksuffix = ""),
hovermode = "closest",
hoverlabel = list(bgcolor = eig_colors[1]),
# add target line
shapes = list(
list(
type = "line",
xref = "paper",
x0 = 0, x1 = 1,
y0 = y_lvl, y1 = y_lvl,
line = list(color = eig_colors[1], width = 2, dash = "dash")
)
),
# add label for target
annotations = list(
list(
xref = "paper",
x = 0.33,
y = y_lvl + 0.025,
text = paste0("2000 level, before China joined the WTO = " , round(y_lvl, 1),"M"),
showarrow = FALSE,
font = list(color = eig_colors[2], size = 12),
xanchor = "left",
yanchor = "middle"
)
)
)
})
output$text_motor_emp <- renderUI({
HTML('<p>With the introduction of reciprocal tariffs on April 2nd, President Trump <a href = "https://www.nytimes.com/2025/04/03/business/economy/trump-tariffs-us-manufacturing-economy.html" target="_blank"> said</a> that “jobs and factories will come roaring back.” There are 1.0 million vehicle-related manufacturing jobs, down from 1.3 million in 2000, the level from just before China joined the WTO in 2001.</p>'
)})
## Motor vehicles and parts share of private employment ##
motor_share_df = tibble(
quarter = as.Date(as.yearqtr(time(motor_share))),
motor_share = as.numeric(motor_share)*100,
hover_label = format(as.yearqtr(quarter), "%Y Q%q")
)
output$plotly_motor_share <- renderPlotly({
# Dynamically generate tick dates: Q1 every 5 years
date_range <- range(motor_share_df$quarter)
start_year <- lubridate::year(date_range[1])
end_year   <- lubridate::year(date_range[2])
tick_years <- c(start_year,
seq((start_year %/% 5 + 1)*5, end_year %/% 5*5, by = 5))
tick_dates <- c(as.Date(paste0(tick_years, "-01-01")),
tail(date_range, 1)) %>% unique()  # Q1 of each year
tick_texts <- as.character(as.yearqtr(tick_dates))
y_lvl = motor_share_df %>% mutate(year = lubridate::year(quarter)) %>%
filter(year == 2000) %>% summarise(y = mean(motor_share))
y_lvl = as.numeric(y_lvl[1,1])
plot_ly(
data = motor_share_df,
x = ~quarter,
y = ~motor_share,
type = 'scatter',
mode = 'lines',
line = list(color = eig_colors[1], width = 2),
text = ~hover_label,
hovertemplate = "%{x}: %{y:,.1f}%<extra></extra>") %>%
layout(
xaxis = list(title = "Time (Quarterly)",
tickvals = tick_dates,
ticktext = tick_texts,
hoverformat = "%Y Q%q",
range = c(tick_dates[1], tick_dates[length(tick_dates)])),
yaxis = list(title = "Share of Private-Sector Workers (%)",
tickformat = ".1f",
ticksuffix = "%"),
hovermode = "closest",
hoverlabel = list(bgcolor = eig_colors[1]),
# add target line
shapes = list(
list(
type = "line",
xref = "paper",
x0 = 0, x1 = 1,
y0 = y_lvl, y1 = y_lvl,
line = list(color = eig_colors[1], width = 2, dash = "dash")
)
),
# add label for target
annotations = list(
list(
xref = "paper",
x = 0.31,
y = y_lvl + 0.015,
text = paste0("2000 level, before China joined the WTO = " , round(y_lvl, 1),"%"),
showarrow = FALSE,
font = list(color = eig_colors[2], size = 12),
xanchor = "left",
yanchor = "middle"
)
)
)
})
output$text_motor_share <- renderUI({
HTML('<p>With the introduction of reciprocal tariffs on April 2nd, President Trump <a href = "https://www.nytimes.com/2025/04/03/business/economy/trump-tariffs-us-manufacturing-economy.html" target="_blank"> said</a> that “jobs and factories will come roaring back.” Vehicle-related manufacturing jobs made up 0.7 percent of total U.S. jobs in Q1 2025, down from 1.2 percent in 2000, the level from just before China joined the WTO in 2001.</p>'
)})
## Employment in manufacturing, counties most affected by the "China shock"  ##
china_shock_df <- tibble(year = time(china_shock_yr),
cs_manu_emp = as.numeric(china_shock_yr),
hover_label = as.character(year))
output$plotly_china_shock <- renderPlotly({
# Dynamically generate tick dates: Q1 every 5 years
start_year <- china_shock_df$year[1]
end_year   <- china_shock_df$year[nrow(china_shock_df)]
tick_years <- c(seq(start_year, end_year, by = 5), end_year)
tick_texts <- as.character(tick_years)
y_lvl <- china_shock_df %>% filter(year == 2000) %>% .$cs_manu_emp
plot_ly(
data = china_shock_df,
x = ~year,
y = ~cs_manu_emp,
type = 'scatter',
mode = 'lines',
line = list(color = eig_colors[1], width = 2),
text = ~hover_label,
hovertemplate = "%{x}: %{y:,.1f}K<extra></extra>"
) %>%
layout(
xaxis = list(title = "Time (Annual)",
tickvals = tick_years,
hoverformat = "%Y Q%q",
range = c(tick_years[1], tick_years[length(tick_years)])),
yaxis = list(title = "Employment (Thousands of Workers)",
tickformat = ".0f",
ticksuffix = ""),
hovermode = "closest",
# add target line
shapes = list(
list(
type = "line",
xref = "paper",
x0 = 0, x1 = 1,
y0 = y_lvl, y1 = y_lvl,
line = list(color = eig_colors[1], width = 2, dash = "dash")
)
),
# add label for target
annotations = list(
list(
xref = "paper",
x = 0.28,
y = y_lvl + 8,
text = paste0("2000 level, before China joined the WTO = " , round(y_lvl, 1),"K"),
showarrow = FALSE,
font = list(color = eig_colors[2], size = 12),
xanchor = "left",
yanchor = "middle"
)
)
)
})
output$text_china_shock <- renderUI({
HTML('<p>Identified by <a href = "https://www.nber.org/papers/w21906" target="_blank"> Autor et al. (2016),</a> manufacturing employment in the 145 counties most impacted by trade with China is 473 thousand jobs (2022). The target is set at 649 thousand, the total employment in these counties just before China joined the WTO in 2001.</p>'
)})
}
shinyApp(ui = ui, server = server)
shinyApp(ui = ui, server = server)
